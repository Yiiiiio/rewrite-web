## 项目名称
学术写作与原创性提升平台（前后端分离）


### 背景与目标
- 本平台致力于帮助作者提升论文原创性与学术质量，提供基于大语言模型与写作规范的改写建议、结构优化、引用管理与相似度自查能力。
- 平台不提供、也不宣称“绕过AI检测/降低AI率”的承诺或功能，严格遵守学术诚信与相关法律法规，面向合规的学术写作辅导与质量提升场景。
- 目标：
  - 为作者提供可控、可追踪、可审计的写作建议与改写工作流。
  - 提供引用与参考文献管理、格式校验、相似度自查与改进建议。
  - 提供透明的模型使用记录与可解释提示，降低误用与侵权风险。
  - 以“文本改写”为核心主路径：通过调用 OpenAI 模型并以可版本化的 Prompt 模板进行编排，提供三种改写级别（轻度/平衡/重度），在左右分栏页面对原文与改写结果进行对照与交互。


### 范围与术语
- 原创性提升：通过改写建议、结构优化、证据补强与引用完善来减少不当复用与表达重复。
- 相似度自查：基于公开语料或第三方查重服务的相似度检测与可视化标注，仅作参考。
- 质量提升：语法纠错、术语统一、风格一致性、段落逻辑优化与可读性改进。
- 合规提示：自动提示潜在的学术不端风险（如未标注引用、过度改写导致事实漂移）。


### 用户画像与角色
- 访客用户：体验公开示例、阅读文档与定价。
- 注册用户（作者/学生/研究人员）：创建与管理文稿，使用原创性与质量提升工具，导出报告。
- 审阅者（导师/编辑）：对文稿进行评审、批注与变更建议。
- 组织管理员（高校/机构）：管理成员、用量、计费与合规策略。
- 平台运营管理员：内容/模型配置、风控与审计、统计报表。


### 核心业务流程（高层）
1. 创建文稿：用户上传/粘贴文本或从模板新建（支持多学科模板）。
2. 预处理：分段、分句、术语抽取与引用解析。
3. 原创性与质量分析：
   - 相似度自查（第三方/内置）：标注可疑片段与来源指示（若可得）。
   - 质量分析：语法、风格、一致性、逻辑结构与可读性打分。
4. 改进建议生成：提供逐段落的改写建议、证据补强点、引用补全与格式修复建议。
5. 人机协同编辑：用户在编辑器中逐条采纳/拒绝建议，保留版本与审计记录。
6. 引用与格式校验：自动生成或校验参考文献（APA/MLA/Chicago/GB/T 7714 等）。
7. 报告导出：导出原创性改进报告、质量评分报告与变更对比清单（Diff）。
8. 审阅协作（可选）：邀请审阅者批注与给出修改建议，形成合并与回退机制。


### 功能需求
#### 1) 账号与权限
- 邮箱/手机号注册登录，OAuth（校园/机构单点可选）。
- 角色与权限：作者、审阅者、组织管理员、平台管理员。
- 安全：MFA、设备管理、登录告警、细粒度令牌与会话控制。

#### 2) 文稿管理
- 文稿创建/导入/导出（DOCX、Markdown、LaTeX、PDF 预览）。
- 版本管理：自动保存、快照、版本对比、回滚。
- 标签与搜索：按学科、阶段、关键词检索。

#### 3) 原创性提升与改写建议
- 段落级建议：
  - 多候选改写与风格选项（学术性/简洁性/叙述性/综述性）。
  - 保真检查：提示事实漂移与引用缺失风险，要求用户确认来源。
  - 术语统一与定义一致性建议。
- 全文级建议：结构重组、摘要/引言/相关工作/方法/实验/结论的均衡性建议。
- 可解释性：对每条建议提供“原因说明”和“影响范围”。
- 日志与审计：记录每次模型调用与用户采纳/拒绝操作。

##### 改写模式与交互（核心）
- 改写级别（默认“平衡”）：
  - 轻度：更偏向语法修正与自然表达，尽量保持原句式与术语。
  - 平衡：在保持语义与论证逻辑不变的前提下进行适度重写与结构微调。
  - 重度：在保真与学术边界内大幅调整表述与句式结构，避免事实漂移。
- 可控参数：温度/保守度、长度保持（±10%/±20%）、术语/专有名词保护清单、引用保留（如 [1],[REF] 不变）、是否允许拆分/合并句子。
- 交互能力：逐段改写、批量改写、改写历史与一键回退、对比视图（Diff）、复制/替换原文、字数统计与进度提示。
- 文本上限：单次输入最大字符数/Token 配额；超限分段处理并显示进度条。

##### Prompt 编排与模板
- 结构：系统提示 + 角色 + 规则 + 示例（few-shot，可选） + 用户文本。
- 模板版本化与灰度：按学科、文体、语言（中/英）与改写级别管理；支持 A/B 实验。
- 支持术语保护、引用标记与格式占位符（如 [REF1] 保留不变）。

##### 模型适配与调用策略
- OpenAI 模型适配：可配置 gpt-4.1/4o 等；设置最大 Token、响应格式与安全过滤。
- 重试与幂等：超时/429/5xx 指数退避重试；请求幂等键；可中断/恢复。
- 成本与配额：按字符/Token 计量；用户与组织级速率与日额；费用预估与实时用量提示。

#### 4) 相似度自查与来源标注（参考性质）
- 对接第三方查重接口或采用开源近似查找生成“参考相似度指标”，不承诺准确性与覆盖率。
- 高亮相似片段、来源候选与上下文对比视图。
- 提示“需要重写/补充引用/改写风险点”。

#### 5) 学术规范与引用管理
- 引用格式：APA/MLA/Chicago/GB/T 7714 等一键转换与校验。
- 文献管理：BibTeX 导入、学术搜索对接（如 Crossref/DOI 查询）。
- 参考文献一致性检查与重复项合并。

#### 6) 质量提升工具
- 语法纠错、拼写检查、术语库与敏感词提示。
- 学术风格与可读性评分（可配置量表，如 Flesch/Kincaid 的近似指标）。
- 图表与附录位置/引用一致性提示（基础规则驱动）。

#### 7) 协作与审核流
- 共享权限：只读/批注/可编辑。
- 批注、讨论区、变更建议（Suggestion）与合并策略。
- 审核通过后生成“审阅通过快照”。

#### 8) 计费与配额
- 套餐：免费试用/按量付费/组织订阅（成员数、请求量、存储配额）。
- 用量统计：模型调用次数、字符数、存储与导出次数。
- 费用中心：发票、对账、退款与税务信息（区域化）。

#### 9) 管理后台与风控
- 用户与组织管理、套餐与折扣配置。
- 模型与提示词（Prompt）版本管理与灰度发布。
- 滥用检测：异常用量告警、关键词风险提示、审计留存与封禁流程。


### 非功能需求
#### 性能与可用性
- 前端首屏 ≤ 2s（CDN 加速、资源拆分与懒加载）。
- 编辑操作响应 ≤ 150ms，建议生成异步并可中断。
- 高可用：关键服务可用性 ≥ 99.9%（多可用区/多实例）。
 - 改写延迟：单段改写 P95 ≤ 6s；批量改写提供实时进度与分段回传；失败自动重试 ≤ 2 次。

#### 安全与合规
- 隐私合规：GDPR/CCPA/本地法规；明示数据用途，提供导出与删除。
- 传输与存储加密：TLS1.2+、静态加密（KMS）。
- 访问控制与审计日志；最小权限（PoLP）。
- 模型合规：不提供“规避检测”的明示承诺；对输出设置行为边界与警示。
 - 调用控制：组织/个人级速率限制与日额上限，超限进入队列等待；成本预警与停机阈值。

#### 可观察性与稳定性
- 监控：业务指标（转化、留存、采纳率）、模型指标（延迟/成本/拒绝率）。
- 日志与追踪：链路追踪（TraceID）、慢查询与失败重试策略。
- 异常治理：熔断、限流与降级策略（优先保障编辑与版本功能）。

#### 可扩展性
- 插件式分析与建议引擎，支持新增学科模板与质量量表。
- 多云/多模型适配层（OpenAI/Anthropic/Azure/本地模型）。


### 前后端分离架构设计
#### 前端（Web + 可选桌面壳/浏览器扩展）
- 技术栈：React/Vue + TypeScript，状态管理（Redux/Pinia），富文本/Markdown/LaTeX 编辑器。
- 构建与部署：Vite/webpack，CI/CD（GitHub Actions/GitLab），CDN（静态资源）。
- 关键模块：
  - 改写工作台（左右分栏）：左侧原文粘贴/编辑，右侧改写结果；顶部模式选择（轻度/平衡/重度）与参数（温度/长度/术语保护）；操作包括“改写/重试/还原/复制/导出”；显示字数与 Token 估算、调用进度与费用预估。
  - 文稿工作台：分段视图、建议面板、对比视图、引用面板、审阅面板。
  - 报告中心：原创性改进报告、质量报告、变更历史。
  - 账户与结算：订阅、用量、发票。

#### 后端（API 网关 + 微服务/模块化单体）
- 技术栈：Node.js（NestJS/Fastify）或 Java（Spring Boot）或 Go，根据团队能力选型。
- 服务划分（可演进）：
  - Auth 服务：认证、授权、MFA、令牌与会话。
  - Document 服务：文稿存储、版本、搜索与导入导出。
  - Analysis 服务：语法/风格/结构分析、术语与规范检查。
  - Similarity 服务：相似度自查与高亮（对接第三方/内置匹配）。
  - Suggestion/Rewrite 服务：OpenAI 调用编排、Prompt 模板与版本管理、术语保护清单、调用配额与成本计量、任务排队与并发控制、结果落库与审计。
  - Billing 服务：计费、配额、订单与发票。
  - Admin 服务：运营配置、风控、审计与报表。
- 数据存储：
  - 事务型：PostgreSQL/MySQL（文稿元数据、账务、权限）。
  - 文档/对象：S3 兼容存储（版本文件、导出报告）。
  - 缓存：Redis（会话、限流、热数据）。
  - 日志与可观测：ELK/ClickHouse + Prometheus + Grafana。
- 通信：REST/GraphQL + WebSocket（协作与进度），消息队列（Kafka/RabbitMQ）解耦长任务。

##### 主要 API（示例）
- POST /api/rewrite/preview：单段改写预览（参数：level、temperature、lengthPolicy、protectedTerms、keepCitations）。
- POST /api/rewrite/batch：批量改写，返回任务 id；支持 WebSocket 进度推送。
- GET /api/rewrite/task/{id}：查询任务状态与结果，支持分页拉取。
- GET /api/prompts/templates：获取模板列表与版本；POST /api/prompts/test：A/B 验证。
- GET /api/usage/estimate：按输入字数返回费用与延迟估算。

#### 模型与算法层
- 编排：按照段落/章节粒度调用多模型（纠错/风格/结构/引用建议）。
- 安全护栏：输出过滤、事实一致性提示、风险标签与人审回路。
- 提示词管理：多版本 A/B 测试，按学科与文体分组。
- 成本控制：缓存、分段增量、优先级队列与配额控制。

#### 第三方集成
- 查重/相似度：对接合规第三方（以其条款为准）。
- 学术检索：Crossref/DOI/学术搜索 API（若许可）。
- 支付：Stripe/国内支付渠道（视地区）。


### 数据模型（概要示意）
- User：id，email，phone，roles，organizationId，settings，mfa。
- Document：id，ownerId，title，discipline，status，createdAt，updatedAt。
- DocumentVersion：id，documentId，diff，snapshotUri，meta（hash，size）。
- Suggestion：id，documentId/sectionId，type，content，rationale，modelMeta，status。
- SimilarityFinding：id，documentId/range，score，sourceRefs，notes。
- Citation：id，documentId，style，bibtex/json，linkedRanges。
- BillingUsage：id，userId/orgId，metricType，amount，period，cost。
- AuditLog：id，actor，action，target，payload，timestamp。
 - RewritingTask：id，documentId/sectionRange，level（light/balance/heavy），params（temperature、lengthPolicy、protectedTerms、keepCitations），status（queued/running/succeeded/failed/cancelled），resultUri/hash，costTokens，latencyMs，createdAt，updatedAt。
 - PromptTemplate：id，name，locale，discipline，level，version，content，isActive，abGroup。


### 里程碑规划（示例）
- M1 可用原型（4-6 周）：
  - 文稿导入/编辑/版本与导出；基础语法与风格建议；基础相似度参考；手动引用管理；基本账户计费。
- M2 协作与报告（4-6 周）：
  - 审阅与批注；原创性与质量报告；多模型编排与风险提示；组织与用量管理。
- M3 稳定与合规（6-8 周）：
  - 性能与观测完善；风控与审计；插件化量表与学科模板；多云与模型切换。


### 风险与边界
- 不承诺“规避检测/降低AI率”，平台仅提供合规的原创性与质量改进建议。
- 相似度与质量评分仅供参考，可能受数据覆盖、领域差异与模型偏差影响。
- 对事实与数据的正确性由作者负责；平台提供风险提示与引用工具辅助。
- 谨防过度改写导致事实漂移或引文错配，需人工确认与审阅。


### 验收标准（示例）
- 功能：M1/M2 列表功能可用，关键路径 E2E 通过率 ≥ 95%。
- 体验：建议与改写生成时间 P95 ≤ 8s（单段改写 ≤ 6s），可中断与重试；编辑器卡顿不可感。
- 质量：用户对建议“采纳率”≥ 30%，“有用”反馈≥ 70%。
- 合规：审计日志完整、隐私与安全基线通过内部评审。
 - 改写一致性：抽样评审中“语义保持/事实不漂移”≥ 95%；术语保护命中率 ≥ 98%。


### KPI（示例）
- 周活跃作者数、文稿留存率、建议采纳率、人均用量与单位成本。
- 组织订阅转化率、审阅协作使用率、报告导出次数。
- 误报/漏报反馈率与修复周期，合规模型拒绝/警示命中率。
 - 改写功能渗透率（使用改写的活跃用户占比）、单次会话改写完成率、平均延迟与每千字成本。


——
本需求分析以“原创性与学术质量提升”为核心目标，明确拒绝“规避检测”的不当诉求，确保平台建设方向合规、可持续与可审计。

